<%= provide(:title, sanitize(@record_label.label_name) + " | Status #{@micropost.id}") %>
<div class="buffalo">
  <% if @record_label.record_label_profile.cover_image == "" %>
    <div class="clinton">
      <% if record_label_signed_in? && @record_label.id == current_record_label.id %>
        you do not have a cover image yet
      <% else %>
        <%= "#{@record_label.label_name} hasn't uploaded a cover photo yet" %>
      <% end %>
    </div>
  <% else %>
    <div class="broadway">
      <img src="<%= @record_label.record_label_profile.cover_image %>" width="100%" height="auto" />
    </div>
  <% end %>
  <div class="delaware">
    <div class="hedley winspear">
      <%= link_to @record_label.label_name, record_label_path(@record_label) %>
    </div>

    <div class="harlem">
      <span class="winspear"><strong><%= "#{@record_label.label_name}" %></strong> posted <%= time_ago_in_words(@micropost.created_at) %> ago</span>
      <% if @record_label == current_record_label %>
    // <%= link_to "delete post", record_label_micropost_path(@record_label, @micropost), data: { confirm: "Are you sure? This cannot be undone. Ever..." }, method: :delete %></span>
      <% end %>
      <div class="winspear">
        <%= @micropost.content %>
      </div>

      <div class="lisbon">

        <% if fan_signed_in? && current_fan.record_label_micropost_voted?(@micropost) %>
          <%= button_to "−", record_label_micropost_vote_path(@micropost), method: :delete, class: "linwood" %>
        <% elsif artist_signed_in? && current_artist.record_label_micropost_voted?(@micropost) %>
          <%= button_to "−", record_label_micropost_vote_path(@micropost), method: :delete, class: "linwood" %>
        <% elsif record_label_signed_in? && current_record_label.record_label_micropost_voted?(@micropost) %>
          <%= button_to "−", record_label_micropost_vote_path(@micropost), method: :delete, class: "linwood" %>
        <% elsif venue_signed_in? && current_venue.record_label_micropost_voted?(@micropost) %>
          <%= button_to "−", record_label_micropost_vote_path(@micropost), method: :delete, class: "linwood" %>
        <% elsif producer_signed_in? && current_producer.record_label_micropost_voted?(@micropost) %>
          <%= button_to "−", record_label_micropost_vote_path(@micropost), method: :delete, class: "linwood" %>
        <% else %>
          <%= form_for(RecordLabelMicropostVote.new, url: record_label_micropost_votes_path) do |f| %>
            <%= hidden_field_tag :record_label_micropost_id, @micropost.id %>
            <%= f.submit "+", class: "linwood" %>
          <% end %>
        <% end %>


        <strong><%= @micropost.record_label_micropost_votes.count %></strong> // <a class="linden"><%= pluralize(@micropost.record_label_micropost_comments.count, "comment") %></a>
      </div>

      <div class="walden">
        <div class="minnesota">
          <% @micropost.record_label_micropost_comments.sort_by{ |comment| -comment.record_label_micropost_comment_votes.count }.take(100).each do |comment| %>
          <div class="northrup">
            <div class="winspear">
               <%= link_to Artist.find(comment.artist_id).artist_name, artist_path(Artist.find(comment.artist_id)) if comment.fan_id.nil? && comment.record_label_id.nil? && comment.venue_id.nil? && comment.producer_id.nil? %><%= link_to Fan.find(comment.fan_id).fan_name, fan_path(Fan.find(comment.fan_id)) if comment.artist_id.nil? && comment.record_label_id.nil? && comment.venue_id.nil? && comment.producer_id.nil? %><%= link_to RecordLabel.find(comment.record_label_id).label_name, record_label_path(RecordLabel.find(comment.record_label_id)) if comment.artist_id.nil? && comment.fan_id.nil? && comment.venue_id.nil? && comment.producer_id.nil? %><%= link_to Venue.find(comment.venue_id).venue_name, venue_path(Venue.find(comment.venue_id)) if comment.artist_id.nil? && comment.fan_id.nil? && comment.record_label_id.nil? && comment.producer_id.nil? %><%= link_to Producer.find(comment.producer_id).producer_name, producer_path(Producer.find(comment.producer_id)) if comment.artist_id.nil? && comment.fan_id.nil? && comment.record_label_id.nil? && comment.venue_id.nil? %> posted <%= time_ago_in_words(comment.created_at) %> ago
              <% if @record_label == current_record_label || (artist_signed_in? && current_artist.id == comment.artist_id) || (fan_signed_in? && current_fan.id == comment.fan_id) || (record_label_signed_in? && current_record_label.id == comment.record_label_id) || (venue_signed_in? && current_venue.id == comment.venue_id) || (producer_signed_in? && current_producer.id == comment.producer_id) %>
              // <%= link_to "delete comment", record_label_micropost_comment_path(@record_label, @micropost, comment), data: { confirm: "Are you sure? This cannot be undone. Ever..." }, method: :delete %>
              <% end %>
            </div>

            <div class="winspear">
              <%= comment.content %>
            </div>

            <div class="winspear">
              <% if fan_signed_in? && current_fan.record_label_micropost_comment_voted?(comment) %>
                <%= button_to "−", record_label_micropost_comment_vote_path(comment), method: :delete, class: "linwood" %>
              <% elsif artist_signed_in? && current_artist.record_label_micropost_comment_voted?(comment) %>
                <%= button_to "−", record_label_micropost_comment_vote_path(comment), method: :delete, class: "linwood" %>
              <% elsif record_label_signed_in? && current_record_label.record_label_micropost_comment_voted?(comment) %>
                <%= button_to "−", record_label_micropost_comment_vote_path(comment), method: :delete, class: "linwood" %>
              <% elsif venue_signed_in? && current_venue.record_label_micropost_comment_voted?(comment) %>
                <%= button_to "−", record_label_micropost_comment_vote_path(comment), method: :delete, class: "linwood" %>
              <% elsif producer_signed_in? && current_producer.record_label_micropost_comment_voted?(comment) %>
                <%= button_to "−", record_label_micropost_comment_vote_path(comment), method: :delete, class: "linwood" %>
              <% else %>
                <%= form_for(RecordLabelMicropostCommentVote.new, url: record_label_micropost_comment_votes_path) do |f| %>
                  <%= hidden_field_tag :record_label_micropost_comment_id, comment.id %>
                  <%= f.submit "+", class: "linwood" %>
                <% end %>
              <% end %>

              <strong><%= comment.record_label_micropost_comment_votes.count %></strong>
            </div>

          </div>
          <% end %>

          <%= form_for(RecordLabelMicropostComment.new, url: record_label_micropost_comments_path(@record_label, @micropost)) do |f| %>
            <div class="highgate">
              <%= f.text_area :content, placeholder: "leave a comment", class: "court" %>
            </div>
            <div class="ellicott">
              <%= f.submit "comment",  class: "exchange" %>
            </div>
          <% end %>

        </div>
      </div>


    </div>

  </div>
</div>
<%= render 'partials/uni_footer' %>
